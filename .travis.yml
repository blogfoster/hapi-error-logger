# dont run on container based infrastructure
sudo: false
dist: trusty
group: travis_latest

language: node_js
node_js:
  - '8'

cache:
  directories:
    - ./node_modules

branches:
  except:
    - /^v[0-9]/ # dont build tags separately as they are build anyway for the push

install:
  - npm prune
  - npm install

before_script:
  - npm run check

script:
  - npm test

deploy:
  provider: npm
  email: npm@blogfoster.com
  api_key:
    secure: "Iebx5GwgoA4CXaeB64pCD7s1+vCx0TscT53egBJ3yL9T4kK2oOBdajf4gCxeElx42DL1qNOjsdkaOfjJav2lUoz96abu7A7FI83ewxHuSyVP2E5ImCgNSjHSlx0/0ZsCFWLOCYXTsRzfl0nEVyJj+YdvAJ25vq1eaHdhY0WYrtqvVsoQkD//pA2XyV0ZhPUZw5RwcyGniJcslCJli7ZK69vwlCJFiDm6aULGjbGp4tvL4x9P7jBAbm222CGH7quwuPKxbBmKpXdGTGlNmp4WdT6hVP22R0RuhoaeM+2tGGGwCIIY1hQBLeLbuEN3Esi1MlgqhkBtSKfsnHfaWcRxoLwp0vAk46akX7ujAfJS+p5/NYBM9hgDcQELdyIl+VeRJLa/o8R9Cz4A+KO1sjSuZCKMonPscAs290CFGLA4y4cGGOVZXTZpxwuRel1O9/SMnAeyfIBt4teIwp3b6IZdvkgJa6+H+5HrmDR9NBR5IBuhha+j8PiwPYdZ4vnGtrOh+cKlNipU8VibADzoKzVrjwnXLwd3KI3Yn7uQFYT3iTo9T5GoUplq0p7LDdvakZBjuugC9tI//XPZXSKqvx9LZtu4z4Qvs87nBNefotKqIWJSxS4/Xd71y1mDJoKY4Xh49HhOhli3mSjLzvF26TAuzWepVnTV/Qj+Kzf/ZMGIKo8="
  wait-until-deployed: true
  skip_cleanup: true
  on:
    repo: blogfoster/hapi-error-logger
    branch: master
    condition: $(git describe --exact-match HEAD) # only deploy if the commit is referenced by a tag as well
